<!DOCTYPE html>
<html>

<head>
    <title>Data Input</title>
    <style>
        .tx-box {
            display: inline-block;
            margin-right: 20px;
        }

        .label-fixed-width {
            display: inline-block;
            width: 150px;
            text-align: right;
            margin-right: 10px;
            font-size: 16px;
        }
        input[type="text"],
        input[type="date"],
        input[type="number"] {
            width: 100%; /* 입력 필드 너비 조정 */
            height: 40px; /* 입력 필드 높이 조정 */
            font-size: 16px; /* 입력 필드의 텍스트 크기 증가 */
            padding: 5px; /* 입력 필드 내부 패딩 추가 */
        }
        .button-container {
            text-align: center; /* 버튼을 중앙에 위치시킵니다. */
            margin-top: 20px; /* 버튼과 입력 필드 사이에 여백을 추가합니다. */
        }
        button {
            padding: 10px 20px; /* 버튼 크기 조정 */
            margin: 0 10px; /* 버튼 사이의 간격 조정 */
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.8/xlsx.full.min.js"></script>
</head>

<body>

    <h1>Enter Your Data</h1>

    <form id="dataForm">
        <label for="date">날짜(yy.mm.dd):</label>
        <input type="date" id="date" name="date"><br><br>

        <label for="runway">활주로(ex. 14L):</label>
        <input type="text" id="runway" name="runway"><br><br>

        <div class="tx-box">
            <h3>Tx1</h3>
            <!-- Add Tx1 input fields here. For example: -->
            <label class="label-fixed-width" for="tx1_90Hz_35deg">90Hz 35deg:</label>
            <input type="number" id="tx1_90Hz_35deg" name="tx1_90Hz_35deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_90Hz_30deg">90Hz 30deg:</label>
            <input type="number" id="tx1_90Hz_30deg" name="tx1_90Hz_30deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_90Hz_25deg">90Hz 25deg:</label>
            <input type="number" id="tx1_90Hz_25deg" name="tx1_90Hz_25deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_90Hz_20deg">90Hz 20deg:</label>
            <input type="number" id="tx1_90Hz_20deg" name="tx1_90Hz_20deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_90Hz_15deg">90Hz 15deg:</label>
            <input type="number" id="tx1_90Hz_15deg" name="tx1_90Hz_15deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_90Hz_10deg">90Hz 10deg:</label>
            <input type="number" id="tx1_90Hz_10deg" name="tx1_90Hz_10deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_90Hz_5deg">90Hz 5deg:</label>
            <input type="number" id="tx1_90Hz_5deg" name="tx1_90Hz_5deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_90Hz_width">90Hz width:</label>
            <input type="number" id="tx1_90Hz_width" name="tx1_90Hz_width" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_CL">C/L:</label>
            <input type="number" id="tx1_CL" name="tx1_CL" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_150Hz_width">150Hz width:</label>
            <input type="number" id="tx1_150Hz_width" name="tx1_150Hz_width" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_150Hz_5deg">150Hz 5deg:</label>
            <input type="number" id="tx1_150Hz_5deg" name="tx1_150Hz_5deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_150Hz_10deg">150Hz 10deg:</label>
            <input type="number" id="tx1_150Hz_10deg" name="tx1_150Hz_10deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_150Hz_15deg">150Hz 15deg:</label>
            <input type="number" id="tx1_150Hz_15deg" name="tx1_150Hz_15deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_150Hz_20deg">150Hz 20deg:</label>
            <input type="number" id="tx1_150Hz_20deg" name="tx1_150Hz_20deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_150Hz_25deg">150Hz 25deg:</label>
            <input type="number" id="tx1_150Hz_25deg" name="tx1_150Hz_25deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_150Hz_30deg">150Hz 30deg:</label>
            <input type="number" id="tx1_150Hz_30deg" name="tx1_150Hz_30deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx1_150Hz_35deg">150Hz 35deg:</label>
            <input type="number" id="tx1_150Hz_35deg" name="tx1_150Hz_35deg" step="0.0001"><br>
        </div>

        <div class="tx-box">
            <h3>Tx2</h3>
            <label class="label-fixed-width" for="tx2_90Hz_35deg">90Hz 35deg:</label>
            <input type="number" id="tx2_90Hz_35deg" name="tx2_90Hz_35deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_90Hz_30deg">90Hz 30deg:</label>
            <input type="number" id="tx2_90Hz_30deg" name="tx2_90Hz_30deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_90Hz_25deg">90Hz 25deg:</label>
            <input type="number" id="tx2_90Hz_25deg" name="tx2_90Hz_25deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_90Hz_20deg">90Hz 20deg:</label>
            <input type="number" id="tx2_90Hz_20deg" name="tx2_90Hz_20deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_90Hz_15deg">90Hz 15deg:</label>
            <input type="number" id="tx2_90Hz_15deg" name="tx2_90Hz_15deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_90Hz_10deg">90Hz 10deg:</label>
            <input type="number" id="tx2_90Hz_10deg" name="tx2_90Hz_10deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_90Hz_5deg">90Hz 5deg:</label>
            <input type="number" id="tx2_90Hz_5deg" name="tx2_90Hz_5deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_90Hz_width">90Hz width:</label>
            <input type="number" id="tx2_90Hz_width" name="tx2_90Hz_width" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_CL">C/L:</label>
            <input type="number" id="tx2_CL" name="tx2_CL" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_150Hz_width">150Hz width:</label>
            <input type="number" id="tx2_150Hz_width" name="tx2_150Hz_width" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_150Hz_5deg">150Hz 5deg:</label>
            <input type="number" id="tx2_150Hz_5deg" name="tx2_150Hz_5deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_150Hz_10deg">150Hz 10deg:</label>
            <input type="number" id="tx2_150Hz_10deg" name="tx2_150Hz_10deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_150Hz_15deg">150Hz 15deg:</label>
            <input type="number" id="tx2_150Hz_15deg" name="tx2_150Hz_15deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_150Hz_20deg">150Hz 20deg:</label>
            <input type="number" id="tx2_150Hz_20deg" name="tx2_150Hz_20deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_150Hz_25deg">150Hz 25deg:</label>
            <input type="number" id="tx2_150Hz_25deg" name="tx2_150Hz_25deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_150Hz_30deg">150Hz 30deg:</label>
            <input type="number" id="tx2_150Hz_30deg" name="tx2_150Hz_30deg" step="0.0001"><br>
            <label class="label-fixed-width" for="tx2_150Hz_35deg">150Hz 35deg:</label>
            <input type="number" id="tx2_150Hz_35deg" name="tx2_150Hz_35deg" step="0.0001"><br>
        </div>
        <div class="button-container">
            <button type="button" id="saveToExcel">Save to Excel</button>
            <button type="button" id="fillRandom">Fill Random Data</button>
        </div>
    </form>

    <script>
        // 날짜 포맷 변경 함수
        function formatDate(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear().toString().substring(2); // 년도의 마지막 두 자리
            const month = (date.getMonth() + 1).toString().padStart(2, '0'); // 월 (0부터 시작하므로 1을 더함)
            const day = date.getDate().toString().padStart(2, '0'); // 일
            return `${year}.${month}.${day}`;
        }
    
        document.getElementById('saveToExcel').addEventListener('click', function() {
            // Get date and runway from user input
            const date = document.getElementById('date').value;
            const runway = document.getElementById('runway').value;
            
            // 사용자가 입력한 날짜를 yy.mm.dd 포맷으로 변환
            const formattedDate = formatDate(date); // 함수 사용
    
            // Create Excel filename
            const filename = `${runway}_GCdata_${formattedDate}.xlsx`;
    
            // 나머지 코드...
            const labels = [
                '날짜', '90Hz 35deg', '90Hz 30deg', '90Hz 25deg', '90Hz 20deg', '90Hz 15deg',
                '90Hz 10deg', '90Hz 5deg', '90Hz width', 'C/L', '150Hz width', '150Hz 35deg',
                '150Hz 30deg', '150Hz 25deg', '150Hz 20deg', '150Hz 15deg', '150Hz 10deg', '150Hz 5deg'
            ];
    
            const tx1Data = [formattedDate];
            const tx2Data = [formattedDate];
            for (const label of labels.slice(1)) {
                const modifiedLabel = label.replace(/ /g, '_');
                tx1Data.push(document.getElementById(`tx1_${modifiedLabel}`).value);
                tx2Data.push(document.getElementById(`tx2_${modifiedLabel}`).value);
            }
    
            // Prepare data for Excel
            const excelData = [
                labels,
                ['Tx1', ...tx1Data],
                ['Tx2', ...tx2Data]
            ];
    
            // Create Excel sheet and book
            const ws = XLSX.utils.aoa_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
    
            // Save Excel file
            XLSX.writeFile(wb, filename);
        });
    </script>

</body>

</html>
