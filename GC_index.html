<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Data Input</title>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: Arial, sans-serif;
        }
    
        .form-container {
            width: 100%;
            max-width: 800px; /* 전체 폼의 최대 너비를 800px로 설정 */
        }
    
        .tx-container {
            display: flex;
            justify-content: space-between; /* Tx1과 Tx2 사이 공간 균등 배분 */
            width: 100%; /* 컨테이너 너비 전체 */
        }
    
        .tx-box {
            width: 49%; /* 각 박스가 차지하는 너비를 절반 가까이 설정 */
            display: flex;
            flex-direction: column;
            margin-right: 10px;
        }
    
        .input-group {
            margin-bottom: 15px; /* 입력 그룹 사이의 간격을 15px로 설정 */
        }
    
        label {
            display: block; /* 라벨을 블록 요소로 설정 */
            text-align: center; /* 텍스트 중앙 정렬 */
            margin-bottom: 5px; /* 라벨 아래 여백 추가 */
        }
    
        input[type="text"], input[type="date"], input[type="number"] {
            width: 100%; /* 입력 필드 너비 전체로 설정 */
            padding: 8px; /* 입력 필드의 패딩을 증가시켜서 더 편안한 입력을 가능하게 함 */
            margin-bottom: 5px; /* 입력 필드 하단에 여백 추가 */
        }
    
        .button-container {
            text-align: center;
            margin-top: 20px; /* 버튼과 입력 필드 사이에 20px 여백 추가 */
        }
    
        button {
            padding: 10px 20px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.8/xlsx.full.min.js"></script>
</head>

<body>
    <div class="form-container">
        <h1>Enter Your Data</h1>
        <form id="dataForm">
            <div>
                <label for="date">날짜(yy.mm.dd):</label>
                <input type="date" id="date" name="date"><br><br>
                <label for="runway">활주로(ex. 14L):</label>
                <input type="text" id="runway" name="runway"><br><br>
            </div>
            <div class="tx-container">
                <div class="tx-box" id="tx1">
                    <h3>Tx1</h3>
                    <label class="label-fixed-width" for="tx1_90Hz_35deg">90Hz 35deg:</label>
                    <input type="number" id="tx1_90Hz_35deg" name="tx1_90Hz_35deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_90Hz_30deg">90Hz 30deg:</label>
                    <input type="number" id="tx1_90Hz_30deg" name="tx1_90Hz_30deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_90Hz_25deg">90Hz 25deg:</label>
                    <input type="number" id="tx1_90Hz_25deg" name="tx1_90Hz_25deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_90Hz_20deg">90Hz 20deg:</label>
                    <input type="number" id="tx1_90Hz_20deg" name="tx1_90Hz_20deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_90Hz_15deg">90Hz 15deg:</label>
                    <input type="number" id="tx1_90Hz_15deg" name="tx1_90Hz_15deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_90Hz_10deg">90Hz 10deg:</label>
                    <input type="number" id="tx1_90Hz_10deg" name="tx1_90Hz_10deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_90Hz_5deg">90Hz 5deg:</label>
                    <input type="number" id="tx1_90Hz_5deg" name="tx1_90Hz_5deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_90Hz_width">90Hz width:</label>
                    <input type="number" id="tx1_90Hz_width" name="tx1_90Hz_width" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_CL">C/L:</label>
                    <input type="number" id="tx1_CL" name="tx1_CL" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_150Hz_width">150Hz width:</label>
                    <input type="number" id="tx1_150Hz_width" name="tx1_150Hz_width" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_150Hz_5deg">150Hz 5deg:</label>
                    <input type="number" id="tx1_150Hz_5deg" name="tx1_150Hz_5deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_150Hz_10deg">150Hz 10deg:</label>
                    <input type="number" id="tx1_150Hz_10deg" name="tx1_150Hz_10deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_150Hz_15deg">150Hz 15deg:</label>
                    <input type="number" id="tx1_150Hz_15deg" name="tx1_150Hz_15deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_150Hz_20deg">150Hz 20deg:</label>
                    <input type="number" id="tx1_150Hz_20deg" name="tx1_150Hz_20deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_150Hz_25deg">150Hz 25deg:</label>
                    <input type="number" id="tx1_150Hz_25deg" name="tx1_150Hz_25deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_150Hz_30deg">150Hz 30deg:</label>
                    <input type="number" id="tx1_150Hz_30deg" name="tx1_150Hz_30deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx1_150Hz_35deg">150Hz 35deg:</label>
                    <input type="number" id="tx1_150Hz_35deg" name="tx1_150Hz_35deg" step="0.0001"><br>
                </div>

                <div class="tx-box" id="tx2">
                    <h3>Tx2</h3>
                    <label class="label-fixed-width" for="tx2_90Hz_35deg">90Hz 35deg:</label>
                    <input type="number" id="tx2_90Hz_35deg" name="tx2_90Hz_35deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_90Hz_30deg">90Hz 30deg:</label>
                    <input type="number" id="tx2_90Hz_30deg" name="tx2_90Hz_30deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_90Hz_25deg">90Hz 25deg:</label>
                    <input type="number" id="tx2_90Hz_25deg" name="tx2_90Hz_25deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_90Hz_20deg">90Hz 20deg:</label>
                    <input type="number" id="tx2_90Hz_20deg" name="tx2_90Hz_20deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_90Hz_15deg">90Hz 15deg:</label>
                    <input type="number" id="tx2_90Hz_15deg" name="tx2_90Hz_15deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_90Hz_10deg">90Hz 10deg:</label>
                    <input type="number" id="tx2_90Hz_10deg" name="tx2_90Hz_10deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_90Hz_5deg">90Hz 5deg:</label>
                    <input type="number" id="tx2_90Hz_5deg" name="tx2_90Hz_5deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_90Hz_width">90Hz width:</label>
                    <input type="number" id="tx2_90Hz_width" name="tx2_90Hz_width" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_CL">C/L:</label>
                    <input type="number" id="tx2_CL" name="tx2_CL" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_150Hz_width">150Hz width:</label>
                    <input type="number" id="tx2_150Hz_width" name="tx2_150Hz_width" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_150Hz_5deg">150Hz 5deg:</label>
                    <input type="number" id="tx2_150Hz_5deg" name="tx2_150Hz_5deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_150Hz_10deg">150Hz 10deg:</label>
                    <input type="number" id="tx2_150Hz_10deg" name="tx2_150Hz_10deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_150Hz_15deg">150Hz 15deg:</label>
                    <input type="number" id="tx2_150Hz_15deg" name="tx2_150Hz_15deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_150Hz_20deg">150Hz 20deg:</label>
                    <input type="number" id="tx2_150Hz_20deg" name="tx2_150Hz_20deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_150Hz_25deg">150Hz 25deg:</label>
                    <input type="number" id="tx2_150Hz_25deg" name="tx2_150Hz_25deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_150Hz_30deg">150Hz 30deg:</label>
                    <input type="number" id="tx2_150Hz_30deg" name="tx2_150Hz_30deg" step="0.0001"><br>
                    <label class="label-fixed-width" for="tx2_150Hz_35deg">150Hz 35deg:</label>
                    <input type="number" id="tx2_150Hz_35deg" name="tx2_150Hz_35deg" step="0.0001"><br>
                </div>
            </div>
            <div class="button-container">
                <button type="button" id="saveToExcel">Save to Excel</button>
                <button type="button" id="fillRandom">Fill Random Data</button>
            </div>
        </form>
    </div>

    <script>
        // 날짜 포맷 변경 함수
        function formatDate(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear().toString().substring(2); // 년도의 마지막 두 자리
            const month = (date.getMonth() + 1).toString().padStart(2, '0'); // 월 (0부터 시작하므로 1을 더함)
            const day = date.getDate().toString().padStart(2, '0'); // 일
            return `${year}.${month}.${day}`;
        }

        document.getElementById('saveToExcel').addEventListener('click', function () {
            // Get date and runway from user input
            const date = document.getElementById('date').value;
            const runway = document.getElementById('runway').value;

            // 사용자가 입력한 날짜를 yy.mm.dd 포맷으로 변환
            const formattedDate = formatDate(date); // 함수 사용

            // Create Excel filename
            const filename = `${runway}_GCdata_${formattedDate}.xlsx`;

            // 나머지 코드...
            const labels = [
                '날짜', '90Hz 35deg', '90Hz 30deg', '90Hz 25deg', '90Hz 20deg', '90Hz 15deg',
                '90Hz 10deg', '90Hz 5deg', '90Hz width', 'C/L', '150Hz width', '150Hz 35deg',
                '150Hz 30deg', '150Hz 25deg', '150Hz 20deg', '150Hz 15deg', '150Hz 10deg', '150Hz 5deg'
            ];

            const tx1Data = [formattedDate];
            const tx2Data = [formattedDate];
            for (const label of labels.slice(1)) {
                const modifiedLabel = label.replace(/ /g, '_');
                tx1Data.push(document.getElementById(`tx1_${modifiedLabel}`).value);
                tx2Data.push(document.getElementById(`tx2_${modifiedLabel}`).value);
            }

            // Prepare data for Excel
            const excelData = [
                labels,
                ['Tx1', ...tx1Data],
                ['Tx2', ...tx2Data]
            ];

            // Create Excel sheet and book
            const ws = XLSX.utils.aoa_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');

            // Save Excel file
            XLSX.writeFile(wb, filename);
        });
    </script>

</body>

</html>
